jQuery(document).ready(function(e){var i=e("#ipt_fsqm_save"),a=e("#ipt_fsqm_preview"),t=e("#ipt_fsqm_ajax_loader"),n=t.data("save"),o=(t.data("preview"),t.data("success")),r=t.find(".ipt_uif_ajax_loader_text"),s=t.find(".ipt_uif_ajax_loader_inner"),f=e("#ipt_fsqm_auto_save");doing_autosave=!1,doing_save=!1,changes=!1,intervalID=null;var d=function(){intervalID=setInterval(function(){doing_autosave||doing_save||!changes||(doing_autosave=!0,i.attr("disabled",!0),a.attr("disabled",!0),f.show(),l(function(){doing_autosave=!1,i.attr("disabled",!1),a.attr("disabled",!1),f.fadeOut("fast")}))},2e4)},_=function(){e(window).on("beforeunload",function(){return changes?"You have unsaved changes. Leaving this page will discard the changes":void 0})},m=function(){e(document).on("click","#ipt_fsqm_settings_save, #ipt_fsqm_add_layout, .ipt_uif_builder_layout_settings, .ipt_uif_builder_layout_del",function(){changes=!0}),e(document).on("dragstop",".ipt_uif_droppable_element, .ipt_uif_builder_layout_tabs",function(){changes=!0}),e(document).on("sortstop",".ipt_uif_builder_drop_here, .ipt_uif_builder_layout_tab",function(){changes=!0}),e(document).on("change","input, select, textarea",function(){changes=!0}),e(document).on("slidestop",function(){changes=!0})},l=function(i){if(!doing_save){doing_save=!0,doing_autosave||(r.html(n),s.addClass("ipt_uif_ajax_loader_animate"),t.show());var a=e(".ipt_uif > form").eq(0).serialize(),f=0,d={action:e(".ipt_uif > form").eq(0).find('[name="action"]').val(),ipt_ps_post:a,ipt_ps_send_as_str:!0,ipt_ps_look_into:"ipt_ps_post"};e.post(ajaxurl,d,function(i){if(s.removeClass("ipt_uif_ajax_loader_animate"),"cheating"==i)r.html("Cheating");else if(e.isNumeric(i)){var a=e("#ipt_fsqm_form #form_id");a.length?a.val(Number(i)):(e('<input type="hidden" name="form_id" id="form_id" value="'+i+'" />').prependTo(e("#ipt_fsqm_form")),window.history.pushState({},"","admin.php?page=ipt_fsqm_all_forms&action=edit&form_id="+Number(i))),f=i,r.html(o)}else r.html("Server Error");changes=!1}).fail(function(){s.removeClass("ipt_uif_ajax_loader_animate"),r.html("HTTP Error")}).always(function(){t.delay(1e3).fadeOut("fast",function(){"function"==typeof i&&i(f),doing_save=!1})})}},u=function(){e(document).on("keydown",function(e){e.ctrlKey&&(83==e.keyCode&&(e.preventDefault(),i.trigger("click")),80==e.keyCode&&(e.preventDefault(),a.trigger("click")))})};i.length&&(i.attr("disabled",!1),m(),d(),_(),i.on("click",function(e){e.preventDefault(),l()}),u()),a.length&&(a.attr("disabled",!1),a.on("click",function(i){i.preventDefault(),l(function(i){var a=e(window).width(),t=e(window).height(),n=1600<a?1600:a,o=0;e("body.admin-bar").length&&(o=28);var r="WP Feedback, Survey & Quiz Manager Pro - Preview",s=ajaxurl+"?action=ipt_fsqm_preview_form&form_id="+i,f=e('<div><iframe src="'+s+'" style="width: 100%; height: 97%; border: 0 none;"></iframe>');f.dialog({autoOpen:!0,modal:!0,width:n-80,height:t-85-o,title:r,closeOnEscape:!0,create:function(i,a){e("body").addClass("ipt_uif_common ipt_uif")},close:function(i,a){e("body").removeClass("ipt_uif_common ipt_uif")}})})}));var p=function(){var i=e("#settings_timer_time_limit_type").val();"page_specific"==i?e("#ipt_fsqm_form").addClass("ipt-fsqm-ps-timer"):e("#ipt_fsqm_form").removeClass("ipt-fsqm-ps-timer")};p(),e("#settings_timer_time_limit_type").on("change",p);var c=function(){if(e("#ipt_fsqm_fb_p_al").length&&(e("#ipt_fsqm_fb_p_al").hide(),e(".ipt_fsqm_fb_hidden_init").removeClass("ipt_fsqm_fb_hidden_init")),e(".ipt_uif_builder_empty").length){try{console.warn("Added an empty container, since none was found. eForm")}catch(e){}e("#ipt_fsqm_add_layout").trigger("click")}};if(c(),e("#ipt-eform-new-form-wizard").length){var v=function(i){var a=i.find("> a"),t=i.data("formCatKey"),n=i.data("formKey");if(e("#eform_form_cat").val(t),e("#eform_form_key").val(n),e("#eform_name").val(a.text()),!i.data("eFormWizardInitiated")){var o=ajaxurl+"?action=eform_wizard_preview&formcat="+t+"&formkey="+n,r=e(a.attr("href")),s=e('<iframe src="'+o+'"></iframe>');s.on("load",function(){r.find(".eform-new-form-wizard-loader").remove()}),r.append(s),i.data("eFormWizardInitiated",!0)}};e("#ipt-eform-new-form-wizard").fadeIn("normal",function(){e("#ipt-eform-new-form-wizard-loader").hide()}).on("tabsbeforeactivate",function(i,a){if(e(i.target).is("#ipt-eform-new-form-main-tab")){var t=e(a.newPanel).find(".eform-form-template");if(!t.length)return e("#eform_form_cat").val(""),void e("#eform_form_key").val("");var n=t.tabs("option","active"),o=t.find(".eform-form-template-li").eq(n);v(o)}else{var r=e(a.newTab);v(r)}}),e("#ipt-eform-new-form-wizard").on("click",".eform-new-form-wizard-responsive-btns button",function(){var i=e(this),a=i.closest(".eform-new-form-wizard-previewer").removeClass("prv-small").removeClass("prv-medium").removeClass("prv-large");i.siblings("button").removeClass("active"),i.addClass("active"),i.hasClass("eform-nfw-res-small")?a.addClass("prv-small"):i.hasClass("eform-nfw-res-medium")?a.addClass("prv-medium"):a.addClass("prv-large")})}});
//# sourceMappingURL=ipt-fsqm-admin.min.js.map